<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
    <title>User's Guide</title>
  </head>
  <body>
    <p>This document provides some guidance about how to use TEAM Engine to 
    execute a test run and view the results. There are three ways to interact 
    with the test harness: a command shell, the web application, or a REST-like 
    API.</p>

    <h2>Command shell</h2>
    <p>
    The core binary distribution (teamengine-core-${project.version}-distribution.zip) 
    includes shell scripts for running test suites in Windows and Unix-like (Bash shell) 
    environments. Unpack the archive into a convenient location (TE_HOME); the contents 
    are as shown below.
    </p>
    <pre>
TE_HOME
  |-- bin/              # shell scripts (windows, unix)
  |-- lib/              # supporting libraries
  |-- resources/        # classpath resources (stylesheets, schemas, etc.)
    </pre>

    <p>
    If desired, set the value of the TE_BASE environment variable in the <code>setenv</code> 
    script; otherwise set it for the user evironment according to the particulars of the 
    operating system in use. Once this is done, change to the appropriate script directory 
    (TE_HOME/bin/{unix,windows}) or add it to the system path.
    </p>

    <p>
    To view a brief summary of a test suite, call <code>listsuites</code> and specify the 
    location of the root CTL script (relative to TE_BASE/scripts).
    </p>
    <pre>
$ listsuites -source=note.ctl

Suite note:note-test ({http://example.net/note-test}note-test)
Sample test suite
Checks the content of a note.</pre>

    <p>
    To execute a test run, call <code>test</code> and specify the location of the root 
    CTL script; the file reference may be an absolute filesystem location or relative 
    to TE_BASE/scripts. The test results will be written to a subdirectory <em>sNNNN</em> 
    created in TE_BASE/users/<em>username</em>/.
    </p>
    <pre>
$ test -source=note.ctl

Testing suite note:note-test in Test Mode with defaultResult of Pass ...
Testing note:main type Mandatory in Test Mode with defaultResult Pass (s0002)
...</pre>

    <h2>Web application</h2>
    <p>
    The web application (teamengine.war) provides a UI for selecting test suites, 
    browsing test documentation, and launching test runs. The welcome page (e.g. 
    http://localhost:8080/teamengine) provides a listing of available test suites. 
    In a new installation a sample suite for the fictitious "XML Note" specification 
    should appear. Additional test suites correspond to entries in the main configuration 
    file located at TE_BASE/config.xml.
    </p>

    <p>
    Select "Login" and then supply the appropriate credentials or register to create 
    a new user account. After logging in, previous test sessions are displayed. Select 
    "Create new session" and choose a test suite to execute.
    </p>

    <h2>REST API</h2>
    <p>
    A REST-like API (based on <a href="http://jcp.org/en/jsr/detail?id=311" target="_blank">
    JAX-RS 1.1</a>) enables programmatic execution of some test suites; currently only
    TestNG-based suites can be run in this manner. It exposes the endpoints listed in Table 1. 
    In the request URIs the <code>{etsCode}</code> and <code>{etsVersion}</code> variables 
    denote the code and version, respectively, for a particular test suite.
    </p>

    <table>
      <caption>Table 1 - REST endpoints</caption>
      <thead>
        <tr>
          <th>URI (relative to base)</th>
          <th>Resource</th>
          <th>Representation</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>/rest/suites</td>
          <td>Test suite collection</td>
          <td>application/xhtml+xml </td>
        </tr>
        <tr>
          <td>/rest/suites/{etsCode}/{etsVersion}</td>
          <td>Test suite documentation</td>
          <td>text/html</td>
        </tr>
        <tr>
          <td>/rest/suites/{etsCode}/{etsVersion}/run</td>
          <td>Test run controller</td>
          <td>application/xml </td>
        </tr>
      </tbody>
    </table>

    <p><img src="./images/warn-16px.png"/> <strong>Warning:</strong> When using the REST API, 
    if any test run argument includes a URI value that contains an ampersand ('&amp;') character 
    in a query component, it must be percent-encoded as %26 since it is a "data octet" in 
    this context (see <a href="http://tools.ietf.org/html/rfc3986#section-2.1" target="_blank">
    RFC 3986, sec. 2.1</a>).</p>

    <p>There are two steps involved in deploying an executable test suite (ETS) 
    implemented using the TestNG framework:</p>
    <ol>
      <li>Unpack the *-ctl-scripts.zip archive corresponding to the test suite 
        into the TE_BASE/scripts directory;</li>
      <li>Put the ETS component (a binary JAR file) and any dependencies into 
        the <code>WEB-INF/lib</code> directory of the web application.</li>
    </ol>

    <p>The <code>*-with-direct-deps</code> archive assembles the ETS and its 
    immediate dependencies into a single bundle; this can be unpacked into the 
    lib directory in step 2 above. In some cases it may be necessary to add other
    downstream (transitive) dependencies. Note that the Tomcat instance does 
      <strong>not</strong> need to be restarted to enable the test suite.
    </p>

  </body>
</html>
